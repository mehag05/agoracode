"use strict";(self.webpackChunkagora_frontend=self.webpackChunkagora_frontend||[]).push([[610],{5610:(e,o,a)=>{a.r(o),a.d(o,{default:()=>r});var s=a(9204),l=a(9643),t=a(3231),i=a(5414),n=a(6507);const r=e=>{let{user:o}=e;const[a,r]=(0,l.useState)(!1),[c,d]=(0,l.useState)((null===o||void 0===o?void 0:o.firstName)||""),[u,m]=(0,l.useState)((null===o||void 0===o?void 0:o.lastName)||""),[f,h]=(0,l.useState)((null===o||void 0===o?void 0:o.deliveryLocation)||""),[v,x]=(0,l.useState)((null===o||void 0===o?void 0:o.customLocation)||""),p=null===o||void 0===o?void 0:o.supertokens_id;(0,l.useEffect)((()=>{const e=new AbortController;return(async()=>{if(p)try{const e=await t.A.get(`http://localhost:3001/user/${p}`);d(e.data.firstName),m(e.data.lastName),h(e.data.deliveryLocation),x(e.data.customLocation)}catch(e){console.error("Error fetching user data:",e)}})(),()=>{e.abort()}}),[p]);return o?(0,n.jsxs)("div",{className:"max-w-2xl mx-auto mt-10 p-6 bg-white shadow-md rounded-lg",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Account Profile"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"font-semibold",children:"Email:"}),(0,n.jsx)("p",{children:o.email})]}),a?(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),console.log("Custom Location before submit:",v);const o={deliveryLocation:f,customLocation:"Off campus residence"===f||"Dorm Room"===f?v:""};console.log("Request Data:",o);const a=localStorage.getItem("sessionToken");try{const e=await t.A.put("http://localhost:3001/api/settings",o,{headers:{Authorization:`Bearer ${a}`}});console.log("Profile updated successfully:",e.data),window.location.reload(),d(e.data.firstName),m(e.data.lastName),h(e.data.deliveryLocation),x(e.data.customLocation),r(!1)}catch(s){console.error("Failed to update profile:",s)}},className:"space-y-4",children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"font-semibold",children:"Delivery Location:"}),(0,n.jsxs)("select",{value:f,onChange:e=>h(e.target.value),className:"w-full p-2 border rounded",children:[(0,n.jsx)("option",{value:"",children:"Select a location"}),(0,n.jsx)("option",{value:"Off campus residence",children:"Off campus residence"}),(0,n.jsx)("option",{value:"Rodin Office",children:"Rodin Office"}),(0,n.jsx)("option",{value:"Harrison Office",children:"Harrison Office"}),(0,n.jsx)("option",{value:"Harnwell Office",children:"Harnwell Office"}),(0,n.jsx)("option",{value:"Dorm Room",children:"Dorm Room"}),(0,n.jsx)("option",{value:"Hill Office",children:"Hill Office"}),(0,n.jsx)("option",{value:"Lauder Office",children:"Lauder Office"}),(0,n.jsx)("option",{value:"Guttman Office",children:"Guttman Office"})]})]}),("Off campus residence"===f||"Dorm Room"===f)&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"font-semibold",children:["Dorm Room"===f?"Dorm Room":`${f} Address`,":"]}),(0,n.jsx)("input",{type:"text",value:v,onChange:e=>x(e.target.value),className:"w-full p-2 border rounded"})]})]}),(0,n.jsx)(s.$,{type:"submit",variant:"bigpurple",children:"Save Changes"}),(0,n.jsx)(s.$,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"font-semibold",children:"First Name:"}),(0,n.jsx)("p",{children:o.firstName||"Not set"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"font-semibold",children:"Last Name:"}),(0,n.jsx)("p",{children:o.lastName||"Not set"})]}),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"font-semibold",children:"Delivery Location:"}),(0,n.jsx)("p",{children:o.deliveryLocation||"Not set"}),("Off campus residence"===o.deliveryLocation||"Dorm Room"===o.deliveryLocation)&&(0,n.jsx)("p",{children:o.customLocation||"Not set"})]})}),(0,n.jsx)(s.$,{variant:"bigpurple",onClick:()=>r(!0),children:"Edit Profile"})]})]})]}):(0,n.jsx)("div",{children:(0,n.jsx)(i.A,{})})}}}]);
//# sourceMappingURL=610.bdd951b7.chunk.js.map