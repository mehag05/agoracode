"use strict";(self.webpackChunkagora_frontend=self.webpackChunkagora_frontend||[]).push([[236],{5236:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var r=a(9643),s=a(3231),n=a(7192),i=a(9204),o=a(891),l=a(7417),c=a(5414),d=a(6507);const m=()=>{const{id:e}=(0,n.g)(),t=(0,n.Zp)(),[a,m]=(0,r.useState)(null),[p,u]=(0,r.useState)(null),[g,h]=(0,r.useState)([]),[x,b]=(0,r.useState)([]);(0,r.useEffect)((()=>{const t=new AbortController;return(async()=>{try{const a=await s.A.get(`http://localhost:3001/api/product/${e}`,{signal:t.signal});m(a.data),h(a.data.images.map((e=>e.image))),b([])}catch(p){s.A.isCancel(p)?console.log("Fetch canceled:",p.message):(console.error("Error fetching product:",p),u("Failed to fetch product details."))}})(),()=>{t.abort()}}),[e]);const j=e=>{const{name:t,value:r}=e.target;a&&m({...a,[t]:r})},v=(e,t)=>{if(t)h((t=>t.filter(((t,a)=>a!==e))));else{var r;const t=null===a||void 0===a||null===(r=a.images[e])||void 0===r?void 0:r.image;t&&b((e=>[...e,t])),m((t=>{if(!t)return null;const a=t.images.filter(((t,a)=>a!==e));return{...t,images:a}}))}},{getRootProps:f,getInputProps:y}=(0,o.VB)({onDrop:async e=>{const t=["image/jpeg","image/png","image/jpg","image/gif","image/webp","image/svg+xml"],a=[];for(const r of e){if(!t.includes(r.type))return void window.alert("You must have uploaded an unsupported image type. HEIC files make our site slow :(. Try JPG, JPEG, PNG, or even GIF! Happy selling!");a.push(r)}h((e=>[...e,...a]))},accept:{"image/jpeg":[".jpeg"],"image/png":[".png"],"image/jpg":[".jpg"],"image/gif":[".gif"],"image/webp":[".webp"],"image/svg+xml":[".svg"]}});return p?(0,d.jsx)("div",{children:p}):a?(0,d.jsx)(l.A,{children:(0,d.jsxs)("div",{className:"p-4",children:[(0,d.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Edit Product"}),(0,d.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),a){const r=new FormData;r.append("name",a.name),r.append("description",a.description||""),r.append("price",a.price.toString()),r.append("category",a.category),r.append("size",a.size||""),r.append("ticketLink",a.ticketLink||""),r.append("approvedForSale","pending"),a.images.forEach((e=>{x.includes(e.image)||r.append("images",e.image)})),g.forEach((e=>{r.append("images",e)}));try{await s.A.put(`http://localhost:3001/api/products/edit/${e}`,r),t("/sell")}catch(p){console.error("Error updating product:",p),u("Failed to update product.")}}},className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium",children:"Product Name"}),(0,d.jsx)("input",{type:"text",name:"name",value:a.name,onChange:j,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium",children:"Description"}),(0,d.jsx)("textarea",{name:"description",value:a.description||"",onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium",children:"Price"}),(0,d.jsx)("input",{type:"number",name:"price",value:a.price,onChange:j,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium",children:"Category"}),(0,d.jsxs)("select",{name:"category",value:a.category,onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",children:[(0,d.jsx)("option",{value:"clothing-item",children:"Clothing Item"}),(0,d.jsx)("option",{value:"accessories",children:"Accessories"}),(0,d.jsx)("option",{value:"dorm-item",children:"Dorm Item"}),(0,d.jsx)("option",{value:"shoes",children:"Shoes"}),(0,d.jsx)("option",{value:"other",children:"Other"})]})]}),"clothing-item"===a.category&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium",children:"Size"}),(0,d.jsx)("input",{type:"text",name:"size",value:a.size||"",onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),"event-ticket"===a.category&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium",children:"Ticket Link"}),(0,d.jsx)("input",{type:"text",name:"ticketLink",value:a.ticketLink||"",onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{...f(),className:"border border-dashed border-gray-300 rounded-md p-4 cursor-pointer",children:[(0,d.jsx)("input",{...y()}),(0,d.jsx)("p",{children:"Drag & drop new images here, or click to select files"})]}),(0,d.jsx)("h2",{children:"Images"}),a.images.length>0&&(0,d.jsx)(d.Fragment,{children:a.images.map(((e,t)=>(0,d.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,d.jsx)("img",{src:e.image,alt:`Product Image ${t+1}`,className:"w-16 h-16 object-cover rounded-md"}),(0,d.jsx)("button",{type:"button",onClick:()=>v(t,!1),className:"text-red-500",children:"Remove"})]},`existing-${t}`)))}),g.length>0&&(0,d.jsx)(d.Fragment,{children:g.map(((e,t)=>{try{const a=URL.createObjectURL(e);return(0,d.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,d.jsx)("img",{src:a,alt:`New Image ${t+1}`,className:"w-16 h-16 object-cover rounded-md"}),(0,d.jsx)("button",{type:"button",onClick:()=>v(t,!0),className:"text-red-500",children:"Remove"})]},`new-${t}`)}catch(p){return console.error("Failed to create object URL:",p),null}}))})]}),(0,d.jsx)(i.$,{variant:"bigpurple",type:"submit",children:"Update Product"})]})]})}):(0,d.jsx)("div",{children:(0,d.jsx)(c.A,{})})}}}]);
//# sourceMappingURL=236.492554d0.chunk.js.map