/*! For license information please see 600.76d06b1d.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkagora_frontend=self.webpackChunkagora_frontend||[]).push([[600],{9600:(e,t,r)=>{r.r(t),r.d(t,{default:()=>C});var s=r(9643),n=r(9204),a=r(3261),i=r(3159),l=r(510),o=r(8062);const c=(0,r(1664).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var d,m="https://js.stripe.com/v3",u=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,h="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",p=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(m).concat(t);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},x=null,g=null,f=null,v=function(e){return null!==x?x:(x=new Promise((function(t,r){if("undefined"!==typeof window&&"undefined"!==typeof document)if(window.Stripe&&e&&console.warn(h),window.Stripe)t(window.Stripe);else try{var s=function(){for(var e=document.querySelectorAll('script[src^="'.concat(m,'"]')),t=0;t<e.length;t++){var r=e[t];if(u.test(r.src))return r}return null}();if(s&&e)console.warn(h);else if(s){if(s&&null!==f&&null!==g){var n;s.removeEventListener("load",f),s.removeEventListener("error",g),null===(n=s.parentNode)||void 0===n||n.removeChild(s),s=p(e)}}else s=p(e);f=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(t,r),g=function(e){return function(){e(new Error("Failed to load Stripe.js"))}}(r),s.addEventListener("load",f),s.addEventListener("error",g)}catch(a){return void r(a)}else t(null)}))).catch((function(e){return x=null,Promise.reject(e)}))},j=!1,y=function(){return d||(d=v(null).catch((function(e){return d=null,Promise.reject(e)})))};Promise.resolve().then((function(){return y()})).catch((function(e){j||console.warn(e)}));var w=r(3231),N=r(8312),b=r(7192),S=r(6507);const k=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];j=!0;var s=Date.now();return y().then((function(e){return function(e,t,r){if(null===e)return null;var s=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"4.3.0",startTime:t})}(s,r),s}(e,t,s)}))}("pk_test_51P9rWqP0k4NljSkNfiv4OhnhnhtFahE0cMAIMndBxPgNWSo99T44olPXLegTvQAeQAOMPpVj4jTsGTmfX56yNW8U00GALScE8U"),E=e=>{let{items:t}=e;const{user:r,loading:s,error:a}=(0,N.Q)(),i=(0,b.Zp)();return(0,S.jsx)(n.$,{variant:"bigpurple",onClick:async()=>{if(t.length>1)return void window.alert("You can only check out one item at a time. Happy Shopping!");if(!r)return i("/auth/signin"),void window.alert("Please sign in to checkout!");const e=await k;console.log("Items:",t);const s=t.map((e=>({name:e.product.name,image:e.product.images[0].image,description:e.product._id,price:100*e.product.price,quantity:1})));console.log("Items to send:",s),console.log("User ID:",r.supertokens_id);try{const t=(await w.A.post("http://localhost:3001/api/create-checkout-session",{items:s,user:r.supertokens_id})).data;if(t&&t.id){const r=await e.redirectToCheckout({sessionId:t.id});r.error&&console.error(r.error.message)}else console.error("Session ID not returned or session is undefined",t)}catch(a){var n;if(w.A.isAxiosError(a))console.error("Failed to create checkout session:",(null===(n=a.response)||void 0===n?void 0:n.data)||a.message);else console.error("Unexpected error:",a)}},children:"Checkout"})};var A=r(3995);const C=()=>{const{items:e,removeItem:t}=(0,i._)(),[r,d]=(0,s.useState)(!1),[m,u]=(0,s.useState)(null);(0,s.useEffect)((()=>{d(!0)}),[]);const h=e.reduce(((e,t)=>{let{product:r}=t;return e+r.price}),0);(0,s.useEffect)((()=>{const t=new AbortController;return(async()=>{const t=[];for(const{product:r}of e){const e=(await w.A.get(`http://localhost:3001/api/product/${r._id}`)).data;"sold"!==e.approvedForSale&&"delivered"!==e.approvedForSale||t.push(e.name)}t.length>0?(u(`These items are not in stock: ${t.join(", ")}`),console.log(t),p(t)):u(null)})(),()=>{t.abort()}}),[e]);const p=r=>{r.forEach((r=>{const s=e.find((e=>{let{product:t}=e;return t.name===r}));s&&t(s.product.id)}))};return(0,S.jsxs)("div",{className:"bg-white",children:[m&&(0,S.jsx)("div",{className:"text-red-500",children:m}),(0,S.jsxs)("div",{className:"mx-auto max-w-2xl px-4 pb-24 pt-16 sm:px-6 lg:max-w-7xl lg:px-8",children:[(0,S.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl",children:"Shopping Cart"}),(0,S.jsxs)("div",{className:"mt-12 lg:grid lg:grid-cols-12 lg:items-start lg:gap-x-12 xl:gap-x-16",children:[(0,S.jsxs)("div",{className:(0,l.cn)("lg:col-span-7",{"rounded-lg border-2 border-dashed border-zinc-200 p-12":r&&0===e.length}),children:[(0,S.jsx)("h2",{className:"sr-only",children:"Items in your shopping cart"}),r&&0===e.length?(0,S.jsxs)("div",{className:"flex h-full flex-col items-center justify-center space-y-1",children:[(0,S.jsx)("div",{"aria-hidden":"true",className:"relative mb-4 h-40 w-40 text-muted-foreground",children:(0,S.jsx)("img",{src:"/empty-cart.png",width:100,height:100,loading:"eager",alt:"empty shopping cart"})}),(0,S.jsx)("h3",{className:"font-semibold text-2xl",children:"Your cart is empty"}),(0,S.jsx)("p",{className:"text-muted-foreground text-center",children:"Whoops! nothing to show here yet."})]}):null,(0,S.jsx)("ul",{className:(0,l.cn)({"divide-y divide-gray-200 border-b border-t border-gray-200":r&&e.length>0}),children:r&&e.map((e=>{var r,s;let{product:i}=e;const c=null===(r=a.rh.find((e=>e.value===i.category)))||void 0===r?void 0:r.label;return(0,S.jsxs)("li",{className:"flex py-6 sm:py-10",children:[(0,S.jsx)("div",{className:"flex-shrink-0",children:(0,S.jsx)("div",{className:"relative h-24 w-24",children:null!==(s=i.images[0])&&void 0!==s&&s.image?(0,S.jsx)("img",{width:100,height:100,src:i.images[0].image,alt:"product image",className:"h-full w-full rounded-md object-cover object-center"}):(0,S.jsx)("div",{className:"flex h-full items-center justify-center bg-secondary",children:(0,S.jsx)(A.A,{"aria-hidden":"true",className:"h-4 w-4 text-muted-foreground"})})})}),(0,S.jsx)("div",{className:"ml-4 flex flex-1 flex-col justify-between sm:ml-6",children:(0,S.jsxs)("div",{className:"relative pr-9 sm:grid sm:grid-cols-2 sm:gap-x-6 sm:pr-0",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{className:"flex justify-between",children:(0,S.jsx)("h3",{className:"text-sm",children:(0,S.jsx)("a",{href:`/product/${i.id}`,className:"font-medium text-gray-700 hover:text-gray-800",children:i.name})})}),(0,S.jsx)("div",{className:"mt-1 flex text-sm",children:(0,S.jsxs)("p",{className:"text-muted-foreground",children:["Category: ",c]})}),(0,S.jsx)("p",{className:"mt-1 text-sm font-medium text-gray-900",children:(0,l.$)(i.price)})]}),(0,S.jsx)("div",{className:"mt-4 sm:mt-0 sm:pr-9 w-20",children:(0,S.jsx)("div",{className:"absolute right-0 top-0",children:(0,S.jsx)(n.$,{"aria-label":"remove product",onClick:()=>t(i.id),variant:"ghost",children:(0,S.jsx)(o.A,{className:"h-5 w-5","aria-hidden":"true"})})})})]})})]},i.id)}))})]}),(0,S.jsxs)("section",{className:"mt-16 rounded-lg bg-gray-50 px-4 py-6 sm:p-6 lg:col-span-5 lg:mt-0 lg:p-8",children:[(0,S.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Order summary"}),(0,S.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("p",{className:"text-sm text-gray-600",children:"Subtotal"}),(0,S.jsx)("p",{className:"text-sm font-medium text-gray-900",children:r?(0,l.$)(h):(0,S.jsx)(c,{className:"h-4 w-4 animate-spin text-muted-foreground"})})]}),(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsx)("p",{className:"text-sm text-gray-600",children:"Tax"}),(0,S.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Calculated at checkout"})]}),(0,S.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[(0,S.jsx)("div",{className:"text-base font-medium text-gray-900",children:"Order Total"}),(0,S.jsx)("div",{className:"text-base font-medium text-gray-900",children:r?(0,l.$)(h):(0,S.jsx)(c,{className:"h-4 w-4 animate-spin text-muted-foreground"})})]})]}),(0,S.jsx)("div",{className:"mt-6",children:(0,S.jsx)(E,{items:e})})]})]})]})]})}}}]);
//# sourceMappingURL=600.76d06b1d.chunk.js.map