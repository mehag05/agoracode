{"version":3,"file":"static/js/236.492554d0.chunk.js","mappings":"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","sources":["components/EditProduct.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { IProduct } from '../schema/Product';\nimport { Button } from '../components/ui/button';\nimport { useDropzone } from 'react-dropzone';\nimport ErrorBoundary from './errorboundary';\nimport Spinner from './Spinner';\n\nconst EditProduct: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const [product, setProduct] = useState<IProduct | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [images, setImages] = useState<File[]>([]);\n  const [removedImages, setRemovedImages] = useState<string[]>([]);\n\n  useEffect(() => {\n    const abortController = new AbortController();\n    const fetchProduct = async () => {\n      try {\n        const response = await axios.get(`${process.env.REACT_APP_API_BASE_URL}/api/product/${id}`, {\n          signal: abortController.signal,\n        });\n        setProduct(response.data);\n        setImages(response.data.images.map((img: { image: string }) => img.image));\n        setRemovedImages([]);\n      } catch (error) {\n        if (axios.isCancel(error)) {\n          console.log('Fetch canceled:', error.message);\n        } else {\n          console.error('Error fetching product:', error);\n          setError('Failed to fetch product details.');\n        }\n      }\n    };\n\n    fetchProduct();\n\n    return () => {\n      abortController.abort();\n    };\n  }, [id]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    if (product) {\n      setProduct({ ...product, [name]: value } as IProduct);\n    }\n  };\n\n  const handleDrop = async (acceptedFiles: File[]) => {\n    const validImageTypes = ['image/jpeg', 'image/png', 'image/jpg', 'image/gif', 'image/webp', 'image/svg+xml'];\n    const newImages: File[] = [];\n\n    for (const file of acceptedFiles) {\n      if (!validImageTypes.includes(file.type)) {\n        window.alert('You must have uploaded an unsupported image type. HEIC files make our site slow :(. Try JPG, JPEG, PNG, or even GIF! Happy selling!');\n        return;\n      }\n      newImages.push(file);\n    }\n\n    setImages((prev) => [...prev, ...newImages]);\n  };\n\n  const removeImage = (index: number, isNewImage: boolean) => {\n    if (isNewImage) {\n      setImages((prev) => prev.filter((_, i) => i !== index));\n    } else {\n      const imageToRemove = product?.images[index]?.image;\n      if (imageToRemove) {\n        setRemovedImages((prev) => [...prev, imageToRemove]);\n      }\n      setProduct((prevProduct) => {\n        if (!prevProduct) return null;\n        const updatedImages = prevProduct.images.filter((_, i) => i !== index);\n        return { ...prevProduct, images: updatedImages } as IProduct;\n      });\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (product) {\n      const formData = new FormData();\n      formData.append('name', product.name);\n      formData.append('description', product.description || '');\n      formData.append('price', product.price.toString());\n      formData.append('category', product.category);\n      formData.append('size', product.size || '');\n      formData.append('ticketLink', product.ticketLink || '');\n      formData.append('approvedForSale', 'pending');\n\n      product.images.forEach((img) => {\n        if (!removedImages.includes(img.image)) {\n          formData.append('images', img.image);\n        }\n      });\n\n      images.forEach((file) => {\n        formData.append('images', file);\n      });\n\n      try {\n        await axios.put(`${process.env.REACT_APP_API_BASE_URL}/api/products/edit/${id}`, formData);\n        navigate('/sell');\n      } catch (error) {\n        console.error('Error updating product:', error);\n        setError('Failed to update product.');\n      }\n    }\n  };\n\n  const { getRootProps, getInputProps } = useDropzone({\n    onDrop: handleDrop,\n    accept: { 'image/jpeg': ['.jpeg'], 'image/png': ['.png'], 'image/jpg': ['.jpg'], 'image/gif': ['.gif'], 'image/webp': ['.webp'], 'image/svg+xml': ['.svg'] },\n  });\n\n  if (error) {\n    return <div>{error}</div>;\n  }\n\n  if (!product) return <div><Spinner/></div>;\n\n  return (\n    <ErrorBoundary>\n      <div className='p-4'>\n        <h1 className='text-xl font-bold mb-4'>Edit Product</h1>\n        <form onSubmit={handleSubmit} className='space-y-4'>\n          <div>\n            <label className='block text-sm font-medium'>Product Name</label>\n            <input\n              type='text'\n              name='name'\n              value={product.name}\n              onChange={handleChange}\n              required\n              className='mt-1 block w-full border border-gray-300 rounded-md p-2'\n            />\n          </div>\n\n          <div>\n            <label className='block text-sm font-medium'>Description</label>\n            <textarea\n              name='description'\n              value={product.description || ''}\n              onChange={handleChange}\n              className='mt-1 block w-full border border-gray-300 rounded-md p-2'\n            />\n          </div>\n\n          <div>\n            <label className='block text-sm font-medium'>Price</label>\n            <input\n              type='number'\n              name='price'\n              value={product.price}\n              onChange={handleChange}\n              required\n              className='mt-1 block w-full border border-gray-300 rounded-md p-2'\n            />\n          </div>\n\n          <div>\n            <label className='block text-sm font-medium'>Category</label>\n            <select\n              name='category'\n              value={product.category}\n              onChange={handleChange}\n              className='mt-1 block w-full border border-gray-300 rounded-md p-2'\n            >\n              <option value='clothing-item'>Clothing Item</option>\n              <option value='accessories'>Accessories</option>\n              <option value='dorm-item'>Dorm Item</option>\n              <option value='shoes'>Shoes</option>\n              {/* <option value='event-ticket'>Event Ticket</option> */}\n              <option value='other'>Other</option>\n              {/* <option value='lease'>Lease</option> */}\n            </select>\n          </div>\n\n          {product.category === 'clothing-item' && (\n            <div>\n              <label className='block text-sm font-medium'>Size</label>\n              <input\n                type='text'\n                name='size'\n                value={product.size || ''}\n                onChange={handleChange}\n                className='mt-1 block w-full border border-gray-300 rounded-md p-2'\n              />\n            </div>\n          )}\n\n          {product.category === 'event-ticket' && (\n            <div>\n              <label className='block text-sm font-medium'>Ticket Link</label>\n              <input\n                type='text'\n                name='ticketLink'\n                value={product.ticketLink || ''}\n                onChange={handleChange}\n                className='mt-1 block w-full border border-gray-300 rounded-md p-2'\n              />\n            </div>\n          )}\n\n          <div>\n            <div {...getRootProps()} className='border border-dashed border-gray-300 rounded-md p-4 cursor-pointer'>\n              <input {...getInputProps()} />\n              <p>Drag & drop new images here, or click to select files</p>\n            </div>\n            <h2>Images</h2>\n            {product.images.length > 0 && (\n              <>\n                {product.images.map((img, index) => (\n                  <div key={`existing-${index}`} className='flex justify-between items-center mt-2'>\n                    <img src={img.image} alt={`Product Image ${index + 1}`} className='w-16 h-16 object-cover rounded-md' />\n                    <button type=\"button\" onClick={() => removeImage(index, false)} className='text-red-500'>Remove</button>\n                  </div>\n                ))}\n              </>\n            )}\n            {images.length > 0 && (\n              <>\n                {images.map((file, index) => {\n                  try {\n                    const objectURL = URL.createObjectURL(file);\n                    return (\n                      <div key={`new-${index}`} className='flex justify-between items-center mt-2'>\n                        <img src={objectURL} alt={`New Image ${index + 1}`} className='w-16 h-16 object-cover rounded-md' />\n                        <button type=\"button\" onClick={() => removeImage(index, true)} className='text-red-500'>Remove</button>\n                      </div>\n                    );\n                  } catch (error) {\n                    console.error('Failed to create object URL:', error);\n                    return null;\n                  }\n                })}\n              </>\n            )}\n          </div>\n\n          <Button variant=\"bigpurple\" type=\"submit\">\n            Update Product\n          </Button>\n        </form>\n      </div>\n    </ErrorBoundary>\n  );\n};\n\nexport default EditProduct;"],"names":["EditProduct","id","useParams","navigate","useNavigate","product","setProduct","useState","error","setError","images","setImages","removedImages","setRemovedImages","useEffect","abortController","AbortController","async","response","axios","get","signal","data","map","img","image","isCancel","console","log","message","fetchProduct","abort","handleChange","e","name","value","target","removeImage","index","isNewImage","prev","filter","_","i","_product$images$index","imageToRemove","prevProduct","updatedImages","getRootProps","getInputProps","useDropzone","onDrop","validImageTypes","newImages","file","acceptedFiles","includes","type","window","alert","push","accept","_jsx","children","ErrorBoundary","_jsxs","className","onSubmit","preventDefault","formData","FormData","append","description","price","toString","category","size","ticketLink","forEach","put","onChange","required","length","_Fragment","src","alt","onClick","objectURL","URL","createObjectURL","Button","variant","Spinner"],"sourceRoot":""}